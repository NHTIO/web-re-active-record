{"version":3,"file":"errors-BuLAqZ9_.js","sources":["../node_modules/.pnpm/@nhtio+web-serialization@1.20250425.0/node_modules/@nhtio/web-serialization/errors.mjs","../src/errors.ts"],"sourcesContent":["var d = Object.defineProperty;\nvar f = (t) => {\n  throw TypeError(t);\n};\nvar p = (t, e, r) => e in t ? d(t, e, { enumerable: !0, configurable: !0, writable: !0, value: r }) : t[e] = r;\nvar h = (t, e, r) => p(t, typeof e != \"symbol\" ? e + \"\" : e, r), b = (t, e, r) => e.has(t) || f(\"Cannot \" + r);\nvar n = (t, e, r) => (b(t, e, \"read from private field\"), r ? r.call(t) : e.get(t)), l = (t, e, r) => e.has(t) ? f(\"Cannot add the same private member more than once\") : e instanceof WeakSet ? e.add(t) : e.set(t, r), E = (t, e, r, s) => (b(t, e, \"write to private field\"), s ? s.call(t, r) : e.set(t, r), r);\nconst u = class extends TypeError {\n  constructor(e, r, s) {\n    const g = s ? { cause: s.cause } : {};\n    super(r, g);\n    /** @private */\n    h(this, \"$__name\");\n    /** @private */\n    h(this, \"$__message\");\n    const _ = this.constructor;\n    if (Object.setPrototypeOf(this, _), this.$__name = e, this.$__message = r, typeof Error.captureStackTrace == \"function\" && Error.captureStackTrace(this, _), typeof this.stack != \"string\" && Object.defineProperty(this, \"stack\", {\n      value: \"\",\n      writable: !0,\n      enumerable: !1,\n      configurable: !0\n    }), this.stack && s && s.trim && s.trim > 0) {\n      const m = this.stack.split(`\n`);\n      m.splice(0, s.trim), this.stack = m.join(`\n`);\n    }\n    Object.defineProperty(this, \"name\", {\n      get: () => this.$__name,\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"message\", {\n      get: () => this.$__message,\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /** @private */\n  get name() {\n    return this.$__name;\n  }\n  /** @private */\n  get message() {\n    return this.$__message;\n  }\n  /** @private */\n  get [Symbol.toStringTag]() {\n    return this.constructor.name;\n  }\n  /** @private */\n  toString() {\n    return `${this.name}: ${this.message}`;\n  }\n  /** @private */\n  [Symbol.toPrimitive](e) {\n    switch (e) {\n      case \"string\":\n        return this.toString();\n      default:\n        return !0;\n    }\n  }\n  /** @private */\n  static [Symbol.hasInstance](e) {\n    if (typeof e == \"object\" && e !== null || typeof e == \"function\") {\n      const r = Object.getPrototypeOf(e);\n      return r.name === this.name || r === this;\n    }\n    return !1;\n  }\n}, A = (t, e, r) => t ? [\n  r,\n  t.details ? t.details.map((s) => s.message).join(\" and \") : t.message\n].filter((s) => typeof s == \"string\").join(\" \") : e;\nclass y extends u {\n  /** @private */\n  constructor(e) {\n    const r = A(\n      e,\n      \"Cannot serialize this value\",\n      \"Cannot serialize this value:\"\n    );\n    super(\"E_PAYLOAD_UNSERIALIZABLE\", r);\n  }\n}\nclass O extends u {\n  /** @private */\n  constructor(e) {\n    const r = `Encoding rule \"${e}\" conflicts with default serialization rules.`;\n    super(\"E_RULE_CONFLICT\", r);\n  }\n}\nvar i, a;\nclass U extends u {\n  /** @private */\n  constructor(r) {\n    super(\"E_VALUE_UNSERIALIZABLE\", \"Encountered an unserializable value\");\n    l(this, i);\n    l(this, a);\n    E(this, i, typeof r), E(this, a, \"\"), Object.defineProperty(this, \"kind\", {\n      get: () => n(this, i),\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"inspection\", {\n      get: () => n(this, a),\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The result of the `typeof` operator on the value that caused the error.\n   */\n  get kind() {\n    return n(this, i);\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The result of the `inspect` function on the value that caused the error.\n   */\n  get inspection() {\n    return n(this, a);\n  }\n}\ni = new WeakMap(), a = new WeakMap();\nvar o;\nclass S extends u {\n  /** @private */\n  constructor(r, s) {\n    super(\"E_VALUE_UNDESERIALIZABLE\", \"Encountered a value which cannot be deserialized\", { cause: s });\n    l(this, o);\n    E(this, o, r.key || \"unknown\"), Object.defineProperty(this, \"kind\", {\n      get: () => n(this, o),\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 7 */\n  /**\n   * The structured data key that caused the error.\n   * @remarks This is used to identify the type of the value that caused the error.\n   */\n  get kind() {\n    return n(this, o) || \"unknown\";\n  }\n}\no = new WeakMap();\nclass I extends u {\n  /** @private */\n  constructor(e) {\n    super(\"E_VALUE_UNPARSEABLE\", \"Encountered a value which cannot be parsed in order to be deserialized\", { cause: e });\n  }\n}\nvar c;\nclass R extends u {\n  /** @private */\n  constructor(r) {\n    const s = `Value was serialized with version ${r}, but the current version is 1.20250425.0`;\n    super(\"E_VALUE_FROM_FUTURE_VERSION\", s);\n    l(this, c);\n    E(this, c, r), Object.defineProperty(this, \"version\", {\n      get: () => n(this, c),\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"current\", {\n      get: () => \"1.20250425.0\",\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The version that caused the error.\n   */\n  get version() {\n    return n(this, c);\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The current version of the library.\n   */\n  get current() {\n    return \"1.20250425.0\";\n  }\n}\nc = new WeakMap();\nconst P = (t) => new Error(\n  `Value was serialized with version ${t}, but the current version is 1.20250425.0`\n);\nexport {\n  y as E_PAYLOAD_UNSERIALIZABLE,\n  O as E_RULE_CONFLICT,\n  R as E_VALUE_FROM_FUTURE_VERSION,\n  S as E_VALUE_UNDESERIALIZABLE,\n  I as E_VALUE_UNPARSEABLE,\n  U as E_VALUE_UNSERIALIZABLE,\n  P as W_VALUE_FROM_PAST_VERSION\n};\n//# sourceMappingURL=errors.mjs.map\n","/**\n * Provides the errors for the encryption module.\n * @module @nhtio/web-encryption/errors\n */\n\ninterface EncryptionErrorOptions {\n  /**\n   * The cause data property of an Error instance indicates the specific original cause of the error.\n   */\n  cause?: Error\n  /**\n   * How many rows to trim from the stack trace.\n   * This is useful for removing the stack trace of the current function from the error.\n   */\n  trim?: number\n}\n\nconst EncryptionError = class extends Error {\n  /** @private */\n  readonly $__name: string\n  /** @private */\n  readonly $__message: string\n\n  constructor(name: string, message: string, options?: EncryptionErrorOptions) {\n    const superOptions = options ? { cause: options.cause } : {}\n    super(message, superOptions)\n    const ErrorConstructor = this.constructor\n    Object.setPrototypeOf(this, ErrorConstructor)\n    this.$__name = name\n    this.$__message = message\n    if ('function' === typeof Error.captureStackTrace) {\n      Error.captureStackTrace(this, ErrorConstructor)\n    }\n    if ('string' !== typeof this.stack) {\n      Object.defineProperty(this, 'stack', {\n        value: '',\n        writable: true,\n        enumerable: false,\n        configurable: true,\n      })\n    }\n    if (this.stack && options && options.trim && options.trim > 0) {\n      const stackLines = this.stack.split('\\n')\n      stackLines.splice(0, options.trim)\n      this.stack = stackLines.join('\\n')\n    }\n    Object.defineProperty(this, 'name', {\n      get: () => this.$__name,\n      enumerable: true,\n      configurable: false,\n    })\n    Object.defineProperty(this, 'message', {\n      get: () => this.$__message,\n      enumerable: true,\n      configurable: false,\n    })\n  }\n\n  /** @private */\n  get name() {\n    return this.$__name\n  }\n\n  /** @private */\n  get message() {\n    return this.$__message\n  }\n\n  /** @private */\n  get [Symbol.toStringTag]() {\n    return this.constructor.name\n  }\n\n  /** @private */\n  toString() {\n    return `${this.name}: ${this.message}`\n  }\n\n  /** @private */\n  [Symbol.toPrimitive](hint: 'number' | 'string' | 'default') {\n    switch (hint) {\n      case 'string':\n        return this.toString()\n      default:\n        return true\n    }\n  }\n\n  /** @private */\n  static [Symbol.hasInstance](instance: unknown) {\n    if ((typeof instance === 'object' && instance !== null) || typeof instance === 'function') {\n      const proto = Object.getPrototypeOf(instance)\n      return proto.name === this.name || proto === this\n    }\n    return false\n  }\n}\n\n/**\n * @private\n */\nclass InsecureAppKeyError extends EncryptionError {\n  constructor() {\n    const msg = 'The value of the encryption key should be at least 16 characters long'\n    super('InsecureAppKeyError', msg)\n  }\n\n  get code() {\n    return 'E_INSECURE_APP_KEY'\n  }\n}\n\n/**\n * @private\n */\nclass MissingAppKeyError extends EncryptionError {\n  constructor() {\n    const msg = 'Missing encryption key. The key is required to encrypt values'\n    super('MissingAppKeyError', msg)\n  }\n\n  get code() {\n    return 'E_MISSING_APP_KEY'\n  }\n}\n\n/**\n * @private\n */\nclass V8UnserializableError extends EncryptionError {\n  #value: unknown\n  constructor(value: unknown) {\n    const msg = 'Value cannot be serialized'\n    super('V8UnserializableError', msg, { trim: 1 })\n    this.#value = value\n  }\n\n  get value() {\n    return this.#value\n  }\n\n  get code() {\n    return 'E_PAYLOAD_UNSERIALIZABLE'\n  }\n}\n\n/**\n * Thrown when the encryption key does not have sufficient length to be considered secure.\n */\nexport const E_INSECURE_APP_KEY = InsecureAppKeyError\n\n/**\n * Thrown when the encryption key is missing.\n */\nexport const E_MISSING_APP_KEY = MissingAppKeyError\n\nexport { E_PAYLOAD_UNSERIALIZABLE } from '@nhtio/web-serialization/errors'\n\nexport type { InsecureAppKeyError, MissingAppKeyError, V8UnserializableError }\n\n/**\n * Thrown when there is a runtime exception\n */\nexport class RuntimeException extends EncryptionError {\n  #code?: string\n  #status?: number\n  constructor(\n    message?: string,\n    options?: ErrorOptions & {\n      code?: string\n      status?: number\n    }\n  ) {\n    const msg = message || 'Runtime exception'\n    super('RuntimeException', msg, { trim: 1 })\n    this.#code = options?.code\n    this.#status = options?.status\n  }\n\n  get code() {\n    return this.#code\n  }\n\n  get status() {\n    return this.#status\n  }\n}\n"],"names":["d","p","h","u","e","r","s","g","_","m","EncryptionError","name","message","options","superOptions","__publicField","ErrorConstructor","stackLines","hint","instance","proto","InsecureAppKeyError","MissingAppKeyError","E_INSECURE_APP_KEY","E_MISSING_APP_KEY","RuntimeException","__privateAdd","_code","_status","__privateSet","__privateGet"],"mappings":"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","x_google_ignoreList":[0]}
{"version":3,"file":"errors-gBU8_uEB.mjs","sources":["../node_modules/.pnpm/@nhtio+web-serialization@1.20250425.0/node_modules/@nhtio/web-serialization/errors.mjs","../src/errors.ts"],"sourcesContent":["var d = Object.defineProperty;\nvar f = (t) => {\n  throw TypeError(t);\n};\nvar p = (t, e, r) => e in t ? d(t, e, { enumerable: !0, configurable: !0, writable: !0, value: r }) : t[e] = r;\nvar h = (t, e, r) => p(t, typeof e != \"symbol\" ? e + \"\" : e, r), b = (t, e, r) => e.has(t) || f(\"Cannot \" + r);\nvar n = (t, e, r) => (b(t, e, \"read from private field\"), r ? r.call(t) : e.get(t)), l = (t, e, r) => e.has(t) ? f(\"Cannot add the same private member more than once\") : e instanceof WeakSet ? e.add(t) : e.set(t, r), E = (t, e, r, s) => (b(t, e, \"write to private field\"), s ? s.call(t, r) : e.set(t, r), r);\nconst u = class extends TypeError {\n  constructor(e, r, s) {\n    const g = s ? { cause: s.cause } : {};\n    super(r, g);\n    /** @private */\n    h(this, \"$__name\");\n    /** @private */\n    h(this, \"$__message\");\n    const _ = this.constructor;\n    if (Object.setPrototypeOf(this, _), this.$__name = e, this.$__message = r, typeof Error.captureStackTrace == \"function\" && Error.captureStackTrace(this, _), typeof this.stack != \"string\" && Object.defineProperty(this, \"stack\", {\n      value: \"\",\n      writable: !0,\n      enumerable: !1,\n      configurable: !0\n    }), this.stack && s && s.trim && s.trim > 0) {\n      const m = this.stack.split(`\n`);\n      m.splice(0, s.trim), this.stack = m.join(`\n`);\n    }\n    Object.defineProperty(this, \"name\", {\n      get: () => this.$__name,\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"message\", {\n      get: () => this.$__message,\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /** @private */\n  get name() {\n    return this.$__name;\n  }\n  /** @private */\n  get message() {\n    return this.$__message;\n  }\n  /** @private */\n  get [Symbol.toStringTag]() {\n    return this.constructor.name;\n  }\n  /** @private */\n  toString() {\n    return `${this.name}: ${this.message}`;\n  }\n  /** @private */\n  [Symbol.toPrimitive](e) {\n    switch (e) {\n      case \"string\":\n        return this.toString();\n      default:\n        return !0;\n    }\n  }\n  /** @private */\n  static [Symbol.hasInstance](e) {\n    if (typeof e == \"object\" && e !== null || typeof e == \"function\") {\n      const r = Object.getPrototypeOf(e);\n      return r.name === this.name || r === this;\n    }\n    return !1;\n  }\n}, A = (t, e, r) => t ? [\n  r,\n  t.details ? t.details.map((s) => s.message).join(\" and \") : t.message\n].filter((s) => typeof s == \"string\").join(\" \") : e;\nclass y extends u {\n  /** @private */\n  constructor(e) {\n    const r = A(\n      e,\n      \"Cannot serialize this value\",\n      \"Cannot serialize this value:\"\n    );\n    super(\"E_PAYLOAD_UNSERIALIZABLE\", r);\n  }\n}\nclass O extends u {\n  /** @private */\n  constructor(e) {\n    const r = `Encoding rule \"${e}\" conflicts with default serialization rules.`;\n    super(\"E_RULE_CONFLICT\", r);\n  }\n}\nvar i, a;\nclass U extends u {\n  /** @private */\n  constructor(r) {\n    super(\"E_VALUE_UNSERIALIZABLE\", \"Encountered an unserializable value\");\n    l(this, i);\n    l(this, a);\n    E(this, i, typeof r), E(this, a, \"\"), Object.defineProperty(this, \"kind\", {\n      get: () => n(this, i),\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"inspection\", {\n      get: () => n(this, a),\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The result of the `typeof` operator on the value that caused the error.\n   */\n  get kind() {\n    return n(this, i);\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The result of the `inspect` function on the value that caused the error.\n   */\n  get inspection() {\n    return n(this, a);\n  }\n}\ni = new WeakMap(), a = new WeakMap();\nvar o;\nclass S extends u {\n  /** @private */\n  constructor(r, s) {\n    super(\"E_VALUE_UNDESERIALIZABLE\", \"Encountered a value which cannot be deserialized\", { cause: s });\n    l(this, o);\n    E(this, o, r.key || \"unknown\"), Object.defineProperty(this, \"kind\", {\n      get: () => n(this, o),\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 7 */\n  /**\n   * The structured data key that caused the error.\n   * @remarks This is used to identify the type of the value that caused the error.\n   */\n  get kind() {\n    return n(this, o) || \"unknown\";\n  }\n}\no = new WeakMap();\nclass I extends u {\n  /** @private */\n  constructor(e) {\n    super(\"E_VALUE_UNPARSEABLE\", \"Encountered a value which cannot be parsed in order to be deserialized\", { cause: e });\n  }\n}\nvar c;\nclass R extends u {\n  /** @private */\n  constructor(r) {\n    const s = `Value was serialized with version ${r}, but the current version is 1.20250425.0`;\n    super(\"E_VALUE_FROM_FUTURE_VERSION\", s);\n    l(this, c);\n    E(this, c, r), Object.defineProperty(this, \"version\", {\n      get: () => n(this, c),\n      enumerable: !0,\n      configurable: !1\n    }), Object.defineProperty(this, \"current\", {\n      get: () => \"1.20250425.0\",\n      enumerable: !0,\n      configurable: !1\n    });\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The version that caused the error.\n   */\n  get version() {\n    return n(this, c);\n  }\n  /* v8 ignore next 6 */\n  /**\n   * The current version of the library.\n   */\n  get current() {\n    return \"1.20250425.0\";\n  }\n}\nc = new WeakMap();\nconst P = (t) => new Error(\n  `Value was serialized with version ${t}, but the current version is 1.20250425.0`\n);\nexport {\n  y as E_PAYLOAD_UNSERIALIZABLE,\n  O as E_RULE_CONFLICT,\n  R as E_VALUE_FROM_FUTURE_VERSION,\n  S as E_VALUE_UNDESERIALIZABLE,\n  I as E_VALUE_UNPARSEABLE,\n  U as E_VALUE_UNSERIALIZABLE,\n  P as W_VALUE_FROM_PAST_VERSION\n};\n//# sourceMappingURL=errors.mjs.map\n","/**\n * Provides the errors for the encryption module.\n * @module @nhtio/web-encryption/errors\n */\n\ninterface EncryptionErrorOptions {\n  /**\n   * The cause data property of an Error instance indicates the specific original cause of the error.\n   */\n  cause?: Error\n  /**\n   * How many rows to trim from the stack trace.\n   * This is useful for removing the stack trace of the current function from the error.\n   */\n  trim?: number\n}\n\nconst EncryptionError = class extends Error {\n  /** @private */\n  readonly $__name: string\n  /** @private */\n  readonly $__message: string\n\n  constructor(name: string, message: string, options?: EncryptionErrorOptions) {\n    const superOptions = options ? { cause: options.cause } : {}\n    super(message, superOptions)\n    const ErrorConstructor = this.constructor\n    Object.setPrototypeOf(this, ErrorConstructor)\n    this.$__name = name\n    this.$__message = message\n    if ('function' === typeof Error.captureStackTrace) {\n      Error.captureStackTrace(this, ErrorConstructor)\n    }\n    if ('string' !== typeof this.stack) {\n      Object.defineProperty(this, 'stack', {\n        value: '',\n        writable: true,\n        enumerable: false,\n        configurable: true,\n      })\n    }\n    if (this.stack && options && options.trim && options.trim > 0) {\n      const stackLines = this.stack.split('\\n')\n      stackLines.splice(0, options.trim)\n      this.stack = stackLines.join('\\n')\n    }\n    Object.defineProperty(this, 'name', {\n      get: () => this.$__name,\n      enumerable: true,\n      configurable: false,\n    })\n    Object.defineProperty(this, 'message', {\n      get: () => this.$__message,\n      enumerable: true,\n      configurable: false,\n    })\n  }\n\n  /** @private */\n  get name() {\n    return this.$__name\n  }\n\n  /** @private */\n  get message() {\n    return this.$__message\n  }\n\n  /** @private */\n  get [Symbol.toStringTag]() {\n    return this.constructor.name\n  }\n\n  /** @private */\n  toString() {\n    return `${this.name}: ${this.message}`\n  }\n\n  /** @private */\n  [Symbol.toPrimitive](hint: 'number' | 'string' | 'default') {\n    switch (hint) {\n      case 'string':\n        return this.toString()\n      default:\n        return true\n    }\n  }\n\n  /** @private */\n  static [Symbol.hasInstance](instance: unknown) {\n    if ((typeof instance === 'object' && instance !== null) || typeof instance === 'function') {\n      const proto = Object.getPrototypeOf(instance)\n      return proto.name === this.name || proto === this\n    }\n    return false\n  }\n}\n\n/**\n * @private\n */\nclass InsecureAppKeyError extends EncryptionError {\n  constructor() {\n    const msg = 'The value of the encryption key should be at least 16 characters long'\n    super('InsecureAppKeyError', msg)\n  }\n\n  get code() {\n    return 'E_INSECURE_APP_KEY'\n  }\n}\n\n/**\n * @private\n */\nclass MissingAppKeyError extends EncryptionError {\n  constructor() {\n    const msg = 'Missing encryption key. The key is required to encrypt values'\n    super('MissingAppKeyError', msg)\n  }\n\n  get code() {\n    return 'E_MISSING_APP_KEY'\n  }\n}\n\n/**\n * @private\n */\nclass V8UnserializableError extends EncryptionError {\n  #value: unknown\n  constructor(value: unknown) {\n    const msg = 'Value cannot be serialized'\n    super('V8UnserializableError', msg, { trim: 1 })\n    this.#value = value\n  }\n\n  get value() {\n    return this.#value\n  }\n\n  get code() {\n    return 'E_PAYLOAD_UNSERIALIZABLE'\n  }\n}\n\n/**\n * Thrown when the encryption key does not have sufficient length to be considered secure.\n */\nexport const E_INSECURE_APP_KEY = InsecureAppKeyError\n\n/**\n * Thrown when the encryption key is missing.\n */\nexport const E_MISSING_APP_KEY = MissingAppKeyError\n\nexport { E_PAYLOAD_UNSERIALIZABLE } from '@nhtio/web-serialization/errors'\n\nexport type { InsecureAppKeyError, MissingAppKeyError, V8UnserializableError }\n\n/**\n * Thrown when there is a runtime exception\n */\nexport class RuntimeException extends EncryptionError {\n  #code?: string\n  #status?: number\n  constructor(\n    message?: string,\n    options?: ErrorOptions & {\n      code?: string\n      status?: number\n    }\n  ) {\n    const msg = message || 'Runtime exception'\n    super('RuntimeException', msg, { trim: 1 })\n    this.#code = options?.code\n    this.#status = options?.status\n  }\n\n  get code() {\n    return this.#code\n  }\n\n  get status() {\n    return this.#status\n  }\n}\n"],"names":["d","p","h","u","e","r","s","g","_","m","A","y","EncryptionError","name","message","options","superOptions","__publicField","ErrorConstructor","stackLines","hint","instance","proto","InsecureAppKeyError","MissingAppKeyError","E_INSECURE_APP_KEY","E_MISSING_APP_KEY","_code","_status","RuntimeException","__privateAdd","__privateSet","__privateGet"],"mappings":"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","x_google_ignoreList":[0]}